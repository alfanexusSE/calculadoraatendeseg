<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Mensalidade - AtendeSEG</title>
    <style>
        :root {
            --color-primary: #7B2D8E;
            --color-primary-dark: #5E1E6E;
            --color-primary-light: #9B4DAE;
            --color-bg: #F8F9FA;
            --color-surface: #FFFFFF;
            --color-text: #1F1F1F;
            --color-text-secondary: #6C757D;
            --color-border: #DEE2E6;
            --color-success: #28A745;
            --color-warning: #FFC107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(123, 45, 142, 0.2);
            text-align: center;
        }

        .header img {
            max-width: 300px;
            height: auto;
            margin-bottom: 15px;
        }

        .header h1 {
            color: white;
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .calculator-section {
            background: var(--color-surface);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--color-primary);
        }

        .plan-item {
            background: #F8F9FA;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .plan-item:hover {
            border-color: var(--color-primary-light);
            box-shadow: 0 4px 12px rgba(123, 45, 142, 0.15);
        }

        .plan-item h3 {
            color: var(--color-primary);
            font-size: 18px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plan-item p {
            color: var(--color-text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .control-group label {
            font-weight: 500;
            color: var(--color-text);
            min-width: 80px;
        }

        .counter {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .counter button {
            background: var(--color-primary);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 6px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .counter button:hover {
            background: var(--color-primary-dark);
            transform: scale(1.05);
        }

        .counter button:active {
            transform: scale(0.95);
        }

        .counter span {
            font-size: 18px;
            font-weight: 600;
            min-width: 40px;
            text-align: center;
            color: var(--color-primary);
        }

        .price-tag {
            background: linear-gradient(135deg, var(--color-primary-light), var(--color-primary));
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            margin-left: auto;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: var(--color-primary);
        }

        .checkbox-item label {
            flex: 1;
            cursor: pointer;
            font-weight: 500;
        }

        .summary-section {
            background: var(--color-surface);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--color-border);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-item span:first-child {
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        .summary-item span:last-child {
            color: var(--color-text);
            font-weight: 600;
            font-size: 14px;
        }

        .total-section {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
            margin: 20px -30px -30px;
            padding: 25px 30px;
            border-radius: 0 0 12px 12px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .total-row:last-child {
            margin-bottom: 0;
        }

        .total-row span:first-child {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .total-row span:last-child {
            color: white;
            font-weight: 700;
            font-size: 18px;
        }

        .total-row.main-total span:first-child {
            font-size: 18px;
            font-weight: 600;
        }

        .total-row.main-total span:last-child {
            font-size: 32px;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .btn-primary {
            background: white;
            color: var(--color-primary);
        }

        .btn-primary:hover {
            background: #F8F9FA;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .installment-note {
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            text-align: center;
            margin-top: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
            color: white;
            padding: 25px 30px;
            border-radius: 12px 12px 0 0;
        }

        .modal-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .modal-header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-text);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn-secondary {
            background: var(--color-border);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: #CED4DA;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-included {
            background: #D4EDDA;
            color: #155724;
        }

        .badge-premium {
            background: #FFF3CD;
            color: #856404;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .summary-section {
                position: static;
            }

            .header h1 {
                font-size: 24px;
            }
        }

        @media print {
            body {
                background: white;
            }
            
            .calculator-section,
            .btn {
                display: none !important;
            }
            
            .summary-section {
                box-shadow: none;
                border: 2px solid var(--color-primary);
            }
        }

        .info-note {
            background: #E7F3FF;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            font-size: 14px;
            color: #0D47A1;
        }

        .discount-applied {
            background: #D4EDDA;
            border-left: 4px solid var(--color-success);
            padding: 12px;
            margin-top: 15px;
            border-radius: 4px;
            font-size: 13px;
            color: #155724;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <img src="logo2.png" alt="AtendeSEG Logo">
            <h1>Calculadora de Mensalidade</h1>
            <p>Configure seu plano personalizado e calcule o valor da sua mensalidade</p>
        </div>

        <div class="main-content">
            <div class="calculator-section">
                <h2 class="section-title">üì¶ Plano Base</h2>
                
                <div class="plan-item">
                    <h3>
                        üéØ Plano Essencial
                        <span class="price-tag">R$ 200,00/m√™s</span>
                    </h3>
                    <p>O plano base j√° inclui:</p>
                    <div style="padding-left: 20px; color: var(--color-text-secondary); font-size: 14px;">
                        ‚úì 1 Conex√£o WhatsApp Business<br>
                        ‚úì 3 Usu√°rios simult√¢neos<br>
                        ‚úì CRM completo para corretoras<br>
                        ‚úì Pipeline de vendas<br>
                        ‚úì Chat em tempo real<br>
                        ‚úì Gest√£o de contatos ilimitada
                    </div>
                </div>

                <h2 class="section-title">‚ûï Recursos Adicionais</h2>

                <div class="plan-item">
                    <h3>üí¨ Conex√µes WhatsApp <span class="price-tag">R$ 99,00/cada</span></h3>
                    <p>Adicione mais n√∫meros de WhatsApp √† sua opera√ß√£o</p>
                    <div class="control-group">
                        <label>Quantidade:</label>
                        <div class="counter">
                            <button onclick="decreaseWhatsApp()">‚àí</button>
                            <span id="whatsappCount">0</span>
                            <button onclick="increaseWhatsApp()">+</button>
                        </div>
                    </div>
                </div>

                <div class="plan-item">
                    <h3>üë• Usu√°rios Adicionais <span class="price-tag">R$ 35,00/cada</span></h3>
                    <p>Expanda sua equipe al√©m dos 3 usu√°rios inclusos</p>
                    <div class="control-group">
                        <label>Quantidade:</label>
                        <div class="counter">
                            <button onclick="decreaseUsers()">‚àí</button>
                            <span id="usersCount">0</span>
                            <button onclick="increaseUsers()">+</button>
                        </div>
                    </div>
                </div>

                <div class="plan-item">
                    <h3>üì± Instagram e Facebook Messenger <span class="price-tag">R$ 60,00</span></h3>
                    <p>Integre suas redes sociais ao atendimento omnichannel</p>
                    <div class="checkbox-item">
                        <input type="checkbox" id="socialMedia" onchange="updateCalculation()">
                        <label for="socialMedia">Adicionar conex√£o de redes sociais</label>
                    </div>
                </div>

                <div class="plan-item" style="border: 2px solid var(--color-primary);">
                    <h3>ü§ñ Agente de Intelig√™ncia Artificial <span class="badge badge-premium">PREMIUM</span></h3>
                    <p>Automa√ß√£o avan√ßada com chatbot inteligente e respostas personalizadas</p>
                    <div style="margin: 15px 0; padding: 15px; background: #FFF9E6; border-radius: 6px;">
                        <strong style="color: var(--color-primary);">Investimento:</strong><br>
                        ‚Ä¢ Mensalidade: <strong>R$ 350,00</strong><br>
                        ‚Ä¢ Desenvolvimento e implanta√ß√£o: <strong>R$ 1.600,00</strong> (pagamento √∫nico)
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aiAgent" onchange="updateCalculation()">
                        <label for="aiAgent">Adicionar Agente de IA ao meu plano</label>
                    </div>
                    <div id="aiDiscount" class="discount-applied" style="display: none;">
                        ‚úì Desconto aplicado! Taxa de implanta√ß√£o padr√£o removida (economia de R$ 400,00)
                    </div>
                </div>

                <div class="plan-item" style="border: 2px solid #9B4DAE; background: linear-gradient(135deg, #F8F4FB 0%, #F0E6F3 100%);">
                    <h3>üíé Cliente Ametista <span class="badge badge-premium">EXCLUSIVO</span></h3>
                    <p>Seu Account Manager pessoal: voc√™ decide, n√≥s executamos</p>
                    <div style="margin: 15px 0; padding: 15px; background: white; border-radius: 6px; border: 1px solid #9B4DAE;">
                        <strong style="color: var(--color-primary);">Experi√™ncia Premium Completa:</strong><br>
                        ‚Ä¢ <strong>Investimento:</strong> 50% da mensalidade (m√≠nimo R$ 300,00)<br>
                        ‚Ä¢ Account Manager dedicado √† sua opera√ß√£o<br>
                        ‚Ä¢ N√≥s fazemos toda configura√ß√£o e ajustes para voc√™<br>
                        ‚Ä¢ Suporte proativo: antecipamos suas necessidades<br>
                        ‚Ä¢ Foque no seu neg√≥cio, cuidamos da tecnologia<br>
                        ‚Ä¢ Melhorias cont√≠nuas sem voc√™ precisar solicitar
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="whiteGlove" onchange="updateCalculation()">
                        <label for="whiteGlove">üíé Quero ser Cliente Ametista</label>
                    </div>
                </div>

                <div class="info-note">
                    <strong>üí° Sobre a Implanta√ß√£o:</strong><br>
                    ‚Ä¢ Taxa padr√£o de implanta√ß√£o: R$ 400,00<br>
                    ‚Ä¢ Ao contratar o Agente de IA junto com o sistema, a taxa padr√£o √© dispensada<br>
                    ‚Ä¢ Valores de desenvolvimento podem ser parcelados em at√© 6x no cart√£o de cr√©dito
                </div>
            </div>

            <div class="summary-section">
                <h2 class="section-title">üìä Resumo do Plano</h2>
                
                <div class="summary-item">
                    <span>Plano Base</span>
                    <span>R$ 200,00</span>
                </div>
                <div id="whatsappSummary" class="summary-item" style="display: none;">
                    <span>Conex√µes WhatsApp (<span id="whatsappQty">0</span>x)</span>
                    <span id="whatsappPrice">R$ 0,00</span>
                </div>
                <div id="usersSummary" class="summary-item" style="display: none;">
                    <span>Usu√°rios Adicionais (<span id="usersQty">0</span>x)</span>
                    <span id="usersPrice">R$ 0,00</span>
                </div>
                <div id="socialSummary" class="summary-item" style="display: none;">
                    <span>Instagram + Facebook</span>
                    <span>R$ 60,00</span>
                </div>
                <div id="aiSummary" class="summary-item" style="display: none;">
                    <span>Agente de IA</span>
                    <span>R$ 350,00</span>
                </div>
                <div id="whiteGloveSummary" class="summary-item" style="display: none;">
                    <span>üíé Cliente Ametista</span>
                    <span id="whiteGlovePrice">R$ 0,00</span>
                </div>

                <div class="total-section">
                    <div class="total-row">
                        <span>Mensalidade</span>
                        <span id="monthlyTotal">R$ 200,00</span>
                    </div>
                    <div class="total-row main-total">
                        <span>Total Mensal</span>
                        <span id="finalTotal">R$ 200,00</span>
                    </div>
                    
                    <div id="oneTimeSection" style="display: none; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 15px; margin-top: 15px;">
                        <div class="total-row">
                            <span>Pagamento √önico</span>
                            <span id="oneTimeTotal">R$ 0,00</span>
                        </div>
                        <div class="installment-note">
                            Pode ser parcelado em at√© 6x no cart√£o
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="openProposalModal()">
                        üéØ Gerar Proposta Comercial
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="proposalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÑ Gerar Proposta Comercial</h2>
                <p>Preencha os dados para gerar sua proposta personalizada</p>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nome da Empresa *</label>
                    <input type="text" id="companyName" placeholder="Ex: Corretora XYZ Seguros">
                </div>
                <div class="form-group">
                    <label>CNPJ</label>
                    <input type="text" id="companyCNPJ" placeholder="00.000.000/0000-00">
                </div>
                <div class="form-group">
                    <label>Nome do Respons√°vel *</label>
                    <input type="text" id="contactName" placeholder="Nome completo">
                </div>
                <div class="form-group">
                    <label>E-mail de Contato *</label>
                    <input type="email" id="contactEmail" placeholder="contato@empresa.com.br">
                </div>
                <div class="form-group">
                    <label>Telefone</label>
                    <input type="tel" id="contactPhone" placeholder="(00) 00000-0000">
                </div>

                <div style="border-top: 2px solid var(--color-border); padding-top: 20px; margin-top: 20px;">
                    <h3 style="color: var(--color-primary); margin-bottom: 15px;">üí∞ Descontos Comerciais</h3>
                    <div class="form-group">
                        <label>Desconto no valor de desenvolvimento/implanta√ß√£o (R$)</label>
                        <input type="number" id="setupDiscount" placeholder="0,00" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Desconto no valor da mensalidade (R$)</label>
                        <input type="number" id="monthlyDiscount" placeholder="0,00" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Motivo do desconto</label>
                        <input type="text" id="discountReason" placeholder="Ex: Cliente especial, parceria estrat√©gica, etc.">
                    </div>
                    <div style="background: #FFF3CD; border-left: 4px solid #856404; padding: 12px; border-radius: 4px; font-size: 13px; color: #856404; margin-top: 5px;">
                        ‚ö†Ô∏è Todo desconto aplicado ser√° registrado na proposta como autorizado pelo <strong>Gerente Comercial Daniel Gois</strong>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeProposalModal()">
                        Cancelar
                    </button>
                    <button class="btn btn-primary" style="flex: 1;" onclick="generateProposal()">
                        üì• Gerar PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let state = {
            whatsapp: 0,
            users: 0,
            socialMedia: false,
            aiAgent: false,
            whiteGlove: false
        };

        const prices = {
            base: 200,
            whatsapp: 99,
            user: 35,
            social: 60,
            aiMonthly: 350,
            aiSetup: 1600,
            standardSetup: 400
        };

        function increaseWhatsApp() {
            state.whatsapp++;
            updateDisplay();
        }

        function decreaseWhatsApp() {
            if (state.whatsapp > 0) {
                state.whatsapp--;
                updateDisplay();
            }
        }

        function increaseUsers() {
            state.users++;
            updateDisplay();
        }

        function decreaseUsers() {
            if (state.users > 0) {
                state.users--;
                updateDisplay();
            }
        }

        function updateCalculation() {
            state.socialMedia = document.getElementById('socialMedia').checked;
            state.aiAgent = document.getElementById('aiAgent').checked;
            state.whiteGlove = document.getElementById('whiteGlove').checked;
            
            const aiDiscount = document.getElementById('aiDiscount');
            if (state.aiAgent) {
                aiDiscount.style.display = 'block';
            } else {
                aiDiscount.style.display = 'none';
            }
            
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('whatsappCount').textContent = state.whatsapp;
            document.getElementById('usersCount').textContent = state.users;

            let monthlyTotal = prices.base;
            let oneTimeTotal = 0;

            const whatsappSummary = document.getElementById('whatsappSummary');
            if (state.whatsapp > 0) {
                const whatsappCost = state.whatsapp * prices.whatsapp;
                monthlyTotal += whatsappCost;
                whatsappSummary.style.display = 'flex';
                document.getElementById('whatsappQty').textContent = state.whatsapp;
                document.getElementById('whatsappPrice').textContent = `R$ ${whatsappCost.toFixed(2)}`;
            } else {
                whatsappSummary.style.display = 'none';
            }

            const usersSummary = document.getElementById('usersSummary');
            if (state.users > 0) {
                const usersCost = state.users * prices.user;
                monthlyTotal += usersCost;
                usersSummary.style.display = 'flex';
                document.getElementById('usersQty').textContent = state.users;
                document.getElementById('usersPrice').textContent = `R$ ${usersCost.toFixed(2)}`;
            } else {
                usersSummary.style.display = 'none';
            }

            const socialSummary = document.getElementById('socialSummary');
            if (state.socialMedia) {
                monthlyTotal += prices.social;
                socialSummary.style.display = 'flex';
            } else {
                socialSummary.style.display = 'none';
            }

            const aiSummary = document.getElementById('aiSummary');
            if (state.aiAgent) {
                monthlyTotal += prices.aiMonthly;
                oneTimeTotal = prices.aiSetup;
                aiSummary.style.display = 'flex';
            } else {
                aiSummary.style.display = 'none';
                oneTimeTotal = prices.standardSetup;
            }

            const whiteGloveSummary = document.getElementById('whiteGloveSummary');
            if (state.whiteGlove) {
                const calculatedCost = monthlyTotal * 0.5;
                const whiteGloveCost = Math.max(300, calculatedCost);
                monthlyTotal += whiteGloveCost;
                whiteGloveSummary.style.display = 'flex';
                document.getElementById('whiteGlovePrice').textContent = `R$ ${whiteGloveCost.toFixed(2)}`;
            } else {
                whiteGloveSummary.style.display = 'none';
            }

            document.getElementById('monthlyTotal').textContent = `R$ ${monthlyTotal.toFixed(2)}`;
            document.getElementById('finalTotal').textContent = `R$ ${monthlyTotal.toFixed(2)}`;

            const oneTimeSection = document.getElementById('oneTimeSection');
            if (oneTimeTotal > 0) {
                oneTimeSection.style.display = 'block';
                document.getElementById('oneTimeTotal').textContent = `R$ ${oneTimeTotal.toFixed(2)}`;
            } else {
                oneTimeSection.style.display = 'none';
            }
        }

        function openProposalModal() {
            document.getElementById('proposalModal').classList.add('active');
        }

        function closeProposalModal() {
            document.getElementById('proposalModal').classList.remove('active');
        }

        function generateProposal() {
            const companyName = document.getElementById('companyName').value.trim();
            const contactName = document.getElementById('contactName').value.trim();
            const contactEmail = document.getElementById('contactEmail').value.trim();

            if (!companyName || !contactName || !contactEmail) {
                alert('Por favor, preencha todos os campos obrigat√≥rios (*)');
                return;
            }

            const companyCNPJ = document.getElementById('companyCNPJ').value.trim();
            const contactPhone = document.getElementById('contactPhone').value.trim();
            const setupDiscount = parseFloat(document.getElementById('setupDiscount').value) || 0;
            const monthlyDiscount = parseFloat(document.getElementById('monthlyDiscount').value) || 0;
            const discountReason = document.getElementById('discountReason').value.trim();

            const proposal = generateProposalHTML(companyName, companyCNPJ, contactName, contactEmail, contactPhone, setupDiscount, monthlyDiscount, discountReason);
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(proposal);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
            }, 500);

            closeProposalModal();
        }

        function generateProposalHTML(companyName, cnpj, contactName, email, phone, setupDiscount, monthlyDiscount, discountReason) {
            const currentDate = new Date().toLocaleDateString('pt-BR', { 
                day: '2-digit', 
                month: 'long', 
                year: 'numeric' 
            });

            let monthlyTotal = prices.base;
            let oneTimeTotal = 0;

            if (state.aiAgent) {
                monthlyTotal += prices.aiMonthly;
                oneTimeTotal = prices.aiSetup;
            } else {
                oneTimeTotal = prices.standardSetup;
            }

            if (state.whatsapp > 0) monthlyTotal += state.whatsapp * prices.whatsapp;
            if (state.users > 0) monthlyTotal += state.users * prices.user;
            if (state.socialMedia) monthlyTotal += prices.social;
            
            const whiteGloveCost = state.whiteGlove ? monthlyTotal * 0.5 : 0;
            if (state.whiteGlove) monthlyTotal += whiteGloveCost;

            oneTimeTotal = Math.max(0, oneTimeTotal - setupDiscount);

            // Aplicar desconto na mensalidade (ap√≥s c√°lculo do White Glove)
            const originalMonthlyTotal = monthlyTotal;
            monthlyTotal = Math.max(0, monthlyTotal - monthlyDiscount);

            let featuresHTML = `
                <div class="feature-section">
                    <h3 style="color: #7B2D8E; margin-top: 25px; margin-bottom: 15px;">Recursos Inclusos no Plano</h3>
                    
                    <h4 style="color: #5E1E6E; margin-top: 20px;">Plataforma Base AtendeSEG</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>WhatsApp Business API:</strong> ${1 + state.whatsapp} conex√£o(√µes) integrada(s)</li>
                        <li><strong>Gest√£o de Usu√°rios:</strong> ${3 + state.users} usu√°rio(s) simult√¢neo(s)</li>
                        <li><strong>CRM Completo:</strong> Gest√£o de contatos ilimitada com campos customiz√°veis</li>
                        <li><strong>Pipeline de Vendas:</strong> Funil visual personaliz√°vel por etapas</li>
                        <li><strong>Chat em Tempo Real:</strong> Interface unificada para todos os atendimentos</li>
                        <li><strong>Hist√≥rico Completo:</strong> Todas as conversas armazenadas permanentemente</li>
                        <li><strong>Departamentos:</strong> Organiza√ß√£o por equipes e especialidades</li>
                        <li><strong>Etiquetas e Filtros:</strong> Categoriza√ß√£o avan√ßada de conversas</li>
                        <li><strong>Mensagens R√°pidas:</strong> Respostas pr√©-configuradas para agilizar atendimento</li>
                        <li><strong>Transfer√™ncia de Conversas:</strong> Entre agentes e departamentos</li>
                        <li><strong>Status de Atendimento:</strong> Aberto, Em Andamento, Resolvido, Fechado</li>
                        <li><strong>Relat√≥rios e M√©tricas:</strong> Tempo de atendimento, satisfa√ß√£o, performance</li>
                        <li><strong>Exporta√ß√£o de Dados:</strong> Relat√≥rios em Excel e CSV</li>
                        <li><strong>Busca Avan√ßada:</strong> Por data, agente, departamento, etiquetas</li>
                        <li><strong>Campos Customizados:</strong> Adicione informa√ß√µes espec√≠ficas do seu neg√≥cio</li>
                        <li><strong>Integra√ß√£o via API:</strong> Conecte com outros sistemas via webhook</li>
                    </ul>
            `;

            if (state.whiteGlove) {
                featuresHTML += `
                    <h4 style="color: #5E1E6E; margin-top: 20px; page-break-inside: avoid;">üíé Cliente Ametista - Experi√™ncia Premium Exclusiva</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Account Manager Dedicado:</strong> Profissional exclusivo 100% focado na sua opera√ß√£o</li>
                        <li><strong>Voc√™ Decide, N√≥s Executamos:</strong> Basta dizer o que precisa, fazemos acontecer</li>
                        <li><strong>Configura√ß√£o Completa por N√≥s:</strong> Zero trabalho t√©cnico da sua parte</li>
                        <li><strong>Suporte Proativo Inteligente:</strong> Antecipamos necessidades antes que voc√™ perceba</li>
                        <li><strong>Melhorias Cont√≠nuas Autom√°ticas:</strong> Otimiza√ß√µes constantes sem voc√™ precisar pedir</li>
                        <li><strong>Atendimento Priorit√°rio VIP:</strong> Prioridade m√°xima absoluta em tudo</li>
                        <li><strong>Consultoria Estrat√©gica Personalizada:</strong> Orienta√ß√£o especializada para seu mercado</li>
                        <li><strong>Desenvolvimento Sob Medida:</strong> Solu√ß√µes customizadas para suas necessidades √∫nicas</li>
                        <li><strong>Relat√≥rios Executivos Exclusivos:</strong> Insights e an√°lises detalhadas mensais</li>
                        <li><strong>Treinamento VIP da Equipe:</strong> Capacita√ß√£o completa e cont√≠nua com prioridade</li>
                        <li><strong>Gest√£o Completa da Plataforma:</strong> Cuidamos de tudo enquanto voc√™ foca no neg√≥cio</li>
                        <li><strong>Linha Direta com Especialista:</strong> Canal exclusivo de comunica√ß√£o priorit√°ria</li>
                    </ul>
                    <div style="background: #F0E6F3; padding: 12px; border-left: 4px solid #9B4DAE; margin-top: 15px; border-radius: 4px;">
                        <strong>üíé Por que ser Cliente Ametista?</strong> Todos os clientes t√™m suporte t√©cnico constante e imediato. Como Cliente Ametista, voc√™ ganha um Account Manager dedicado que gerencia proativamente toda sua opera√ß√£o: implementa melhorias continuamente, cuida de toda parte t√©cnica e trabalhosa, e transforma suas ideias em realidade. Voc√™ apenas decide o que quer, n√≥s cuidamos de fazer acontecer. Foque 100% no seu neg√≥cio enquanto garantimos que sua tecnologia funcione perfeitamente.
                    </div>
                `;
            }

            if (state.socialMedia) {
                featuresHTML += `
                    <h4 style="color: #5E1E6E; margin-top: 20px; page-break-inside: avoid;">Instagram & Facebook Messenger</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Integra√ß√£o Nativa:</strong> Receba mensagens diretas do Instagram e Messenger</li>
                        <li><strong>Interface Unificada:</strong> Gerencie WhatsApp e redes sociais no mesmo lugar</li>
                        <li><strong>Hist√≥rico Centralizado:</strong> Todas as intera√ß√µes em um √∫nico timeline</li>
                        <li><strong>Atendimento Omnichannel:</strong> Cliente continua conversa em qualquer canal</li>
                        <li><strong>Respostas Autom√°ticas:</strong> Configure mensagens para aus√™ncia ou FAQ</li>
                    </ul>
                `;
            }

            if (state.aiAgent) {
                featuresHTML += `
                    <h4 style="color: #5E1E6E; margin-top: 20px; page-break-inside: avoid;">Agente de Intelig√™ncia Artificial (100% Aut√¥nomo)</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Agente Aut√¥nomo:</strong> Atendimento inteligente 24/7 com texto generativo contextualizado</li>
                        <li><strong>175 Bilh√µes de Par√¢metros:</strong> Modelo avan√ßado com processamento em servidor pr√≥prio</li>
                        <li><strong>Treinamento Local:</strong> Base de conhecimento personalizada com informa√ß√µes da sua corretora</li>
                        <li><strong>Coleta de Dados:</strong> Identifica necessidades e coleta informa√ß√µes relevantes</li>
                        <li><strong>Pr√©-Cota√ß√µes Automatizadas:</strong> Solicita dados necess√°rios para or√ßamentos de seguros</li>
                        <li><strong>Qualifica√ß√£o de Leads:</strong> Avalia perfil e necessidades antes de transferir</li>
                        <li><strong>Transfer√™ncia Inteligente:</strong> Encaminha para setor respons√°vel ap√≥s coleta completa</li>
                        <li><strong>Respostas Contextualizadas:</strong> Compreende hist√≥rico e personaliza intera√ß√µes</li>
                        <li><strong>Aprendizado Cont√≠nuo:</strong> Ajustes ilimitados conforme feedback do cliente</li>
                        <li><strong>Sem Limite de Intera√ß√µes:</strong> Capacidade ilimitada de atendimentos simult√¢neos</li>
                        <li><strong>An√°lise de Sentimento:</strong> Detecta urg√™ncia e prioriza atendimentos cr√≠ticos</li>
                        <li><strong>Dashboard de Performance:</strong> M√©tricas detalhadas de assertividade e efici√™ncia</li>
                        <li><strong>Evolu√ß√£o Personalizada:</strong> A assertividade melhora continuamente com seu feedback</li>
                    </ul>
                    <div style="background: #E7F3FF; padding: 12px; border-left: 4px solid #2196F3; margin-top: 15px; border-radius: 4px;">
                        <strong>Importante:</strong> A efic√°cia do agente de IA depende do treinamento cont√≠nuo de contexto e feedback constante do cliente, garantindo respostas cada vez mais alinhadas √†s necessidades espec√≠ficas da sua opera√ß√£o.
                    </div>
                `;
            }

            featuresHTML += `
                    <h4 style="color: #5E1E6E; margin-top: 20px;">Seguran√ßa e Conformidade</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Conformidade LGPD:</strong> Prote√ß√£o de dados conforme legisla√ß√£o</li>
                        <li><strong>Backup Autom√°tico:</strong> Seus dados sempre seguros</li>
                        <li><strong>Permiss√µes Granulares:</strong> Controle o que cada usu√°rio pode acessar</li>
                        <li><strong>Criptografia:</strong> Comunica√ß√£o segura em todos os canais</li>
                    </ul>

                    <h4 style="color: #5E1E6E; margin-top: 20px; page-break-inside: avoid;">Espec√≠fico para Corretoras de Seguros</h4>
                    <ul style="line-height: 1.8;">
                        <li><strong>Estrutura√ß√£o Personalizada:</strong> Auxiliamos na cria√ß√£o de fluxos sob medida (cota√ß√£o, renova√ß√£o, sinistro, d√∫vidas)</li>
                        <li><strong>Configura√ß√£o Customizada:</strong> Cada corretora tem necessidades √∫nicas - estruturamos juntos</li>
                        <li><strong>Motivos de Fechamento:</strong> Sistema para rastrear por que leads n√£o converteram</li>
                        <li><strong>Gest√£o de Renova√ß√µes:</strong> Configure alertas autom√°ticos de vencimento</li>
                        <li><strong>Campanhas Segmentadas:</strong> Ferramentas para disparo em massa personalizado</li>
                        <li><strong>Integra√ß√£o com Seguradoras:</strong> Poss√≠vel via API/Webhook (auxiliamos na implementa√ß√£o)</li>
                    </ul>
                    <div style="background: #FFF3CD; padding: 12px; border-left: 4px solid #FFC107; margin-top: 10px; border-radius: 4px; font-size: 14px;">
                        <strong>Nota:</strong> N√£o fornecemos solu√ß√µes prontas de "f√≥rmula de bolo". Cada corretora possui processos √∫nicos, e nossa miss√£o √© ajud√°-lo a estruturar e implementar o sistema ideal para sua opera√ß√£o espec√≠fica.
                    </div>
                </div>
            `;

            return `
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Proposta Comercial - ${companyName}</title>
                    <style>
                        @page {
                            margin: 2cm;
                        }
                        body {
                            font-family: Arial, sans-serif;
                            line-height: 1.6;
                            color: #333;
                            max-width: 800px;
                            margin: 0 auto;
                            padding: 20px;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 40px;
                            padding-bottom: 20px;
                            border-bottom: 3px solid #7B2D8E;
                        }
                        .header img {
                            max-width: 250px;
                            margin-bottom: 20px;
                        }
                        .header h1 {
                            color: #7B2D8E;
                            font-size: 28px;
                            margin: 10px 0;
                        }
                        .info-section {
                            background: #F8F9FA;
                            padding: 20px;
                            border-radius: 8px;
                            margin-bottom: 30px;
                        }
                        .info-row {
                            margin-bottom: 10px;
                        }
                        .info-row strong {
                            color: #7B2D8E;
                        }
                        .pricing-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 30px 0;
                        }
                        .pricing-table th {
                            background: #7B2D8E;
                            color: white;
                            padding: 15px;
                            text-align: left;
                        }
                        .pricing-table td {
                            padding: 12px 15px;
                            border-bottom: 1px solid #DEE2E6;
                        }
                        .pricing-table tr:hover {
                            background: #F8F9FA;
                        }
                        .total-row {
                            background: #F0E6F3;
                            font-weight: bold;
                            font-size: 18px;
                        }
                        .total-row td {
                            color: #7B2D8E;
                            padding: 20px 15px;
                        }
                        .highlight-box {
                            background: #FFF3CD;
                            border-left: 4px solid #FFC107;
                            padding: 15px;
                            margin: 20px 0;
                        }
                        .footer {
                            margin-top: 50px;
                            padding-top: 20px;
                            border-top: 2px solid #7B2D8E;
                            text-align: center;
                            color: #6C757D;
                        }
                        ul {
                            margin-left: 20px;
                        }
                        li {
                            margin-bottom: 8px;
                        }
                        h3 {
                            color: #7B2D8E;
                            margin-top: 30px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <img src="https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/e1676731-cad5-4dd2-8ba7-d421880d896a" alt="AtendeSEG Logo">
                        <h1>Proposta Comercial</h1>
                        <p>${currentDate}</p>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div class="info-section">
                            <h3 style="margin-top: 0;">Dados do Cliente</h3>
                            <div class="info-row"><strong>Empresa:</strong> ${companyName}</div>
                            ${cnpj ? `<div class="info-row"><strong>CNPJ:</strong> ${cnpj}</div>` : ''}
                            <div class="info-row"><strong>Respons√°vel:</strong> ${contactName}</div>
                            <div class="info-row"><strong>E-mail:</strong> ${email}</div>
                            ${phone ? `<div class="info-row"><strong>Telefone:</strong> ${phone}</div>` : ''}
                        </div>

                        <div class="info-section">
                            <h3 style="margin-top: 0;">Resumo Financeiro</h3>
                            <div class="info-row"><strong>Mensalidade:</strong> <span style="font-size: 20px; color: #7B2D8E;">R$ ${monthlyTotal.toFixed(2)}</span>${monthlyDiscount > 0 ? `<br><small style="color: #155724;">‚úì Inclui desconto de R$ ${monthlyDiscount.toFixed(2)} (aut. Ger. Comercial Daniel Gois)</small>` : ''}</div>
                            ${oneTimeTotal > 0 ? `<div class="info-row"><strong>Investimento Inicial:</strong> <span style="font-size: 18px; color: #5E1E6E;">R$ ${oneTimeTotal.toFixed(2)}</span></div>` : ''}
                            ${oneTimeTotal > 0 ? `<div class="info-row" style="font-size: 12px; color: #6C757D;">Parcel√°vel em at√© 6x sem juros</div>` : ''}
                            <div class="info-row" style="margin-top: 10px;">
                                <strong>Configura√ß√£o:</strong><br>
                                <small>${1 + state.whatsapp} WhatsApp | ${3 + state.users} Usu√°rios${state.socialMedia ? ' | Redes Sociais' : ''}${state.aiAgent ? ' | IA' : ''}${state.whiteGlove ? ' | White Glove' : ''}</small>
                            </div>
                        </div>
                    </div>

                    <h3>Composi√ß√£o do Plano</h3>
                    <table class="pricing-table">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Quantidade</th>
                                <th>Valor Unit.</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Plano Base AtendeSEG</strong><br>
                                    <small>1 WhatsApp + 3 Usu√°rios + CRM Completo</small>
                                </td>
                                <td>1</td>
                                <td>R$ 200,00</td>
                                <td>R$ 200,00</td>
                            </tr>
                            ${state.whatsapp > 0 ? `
                            <tr>
                                <td>Conex√µes WhatsApp Adicionais</td>
                                <td>${state.whatsapp}</td>
                                <td>R$ 99,00</td>
                                <td>R$ ${(state.whatsapp * prices.whatsapp).toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            ${state.users > 0 ? `
                            <tr>
                                <td>Usu√°rios Adicionais</td>
                                <td>${state.users}</td>
                                <td>R$ 35,00</td>
                                <td>R$ ${(state.users * prices.user).toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            ${state.socialMedia ? `
                            <tr>
                                <td>Instagram + Facebook Messenger</td>
                                <td>1</td>
                                <td>R$ 60,00</td>
                                <td>R$ 60,00</td>
                            </tr>
                            ` : ''}
                            ${state.aiAgent ? `
                            <tr>
                                <td><strong>Agente de Intelig√™ncia Artificial</strong></td>
                                <td>1</td>
                                <td>R$ 350,00</td>
                                <td>R$ 350,00</td>
                            </tr>
                            ` : ''}
                            ${state.whiteGlove ? `
                            <tr style="background: #F8F4FB;">
                                <td><strong>üíé Cliente Ametista</strong><br>
                                    <small>Account Management Exclusivo (M√≠nimo R$ 300,00)</small>
                                </td>
                                <td>1</td>
                                <td>R$ ${whiteGloveCost.toFixed(2)}</td>
                                <td>R$ ${whiteGloveCost.toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            ${monthlyDiscount > 0 ? `
                            <tr style="background: #D4EDDA;">
                                <td colspan="3">
                                    <strong style="color: #155724;">üí∞ Desconto na Mensalidade</strong><br>
                                    <small>Desconto autorizado pelo Gerente Comercial <strong>Daniel Gois</strong></small>
                                    ${discountReason ? `<br><small><em>Motivo: ${discountReason}</em></small>` : ''}
                                </td>
                                <td><strong style="color: #155724;">- R$ ${monthlyDiscount.toFixed(2)}</strong></td>
                            </tr>` : ''}
                            <tr class="total-row">
                                <td colspan="3"><strong>${monthlyDiscount > 0 ? 'MENSALIDADE COM DESCONTO' : 'MENSALIDADE TOTAL'}</strong></td>
                                <td><strong>R$ ${monthlyTotal.toFixed(2)}</strong></td>
                            </tr>
                        </tbody>
                    </table>

                    ${featuresHTML}

                    ${oneTimeTotal > 0 ? `
                    <div style="page-break-before: always;"></div>
                    <h3>Investimento Inicial (Pagamento √önico)</h3>
                    <table class="pricing-table">
                        <tbody>
                            ${state.aiAgent ? `
                            <tr>
                                <td><strong>Desenvolvimento e Implanta√ß√£o do Agente de IA</strong><br>
                                    <small>Inclui treinamento, configura√ß√£o e integra√ß√£o</small>
                                </td>
                                <td><strong>R$ ${prices.aiSetup.toFixed(2)}</strong></td>
                            </tr>
                            <tr>
                                <td colspan="2" style="background: #D4EDDA; color: #155724;">
                                    Taxa de implanta√ß√£o padr√£o dispensada (economia de R$ 400,00)
                                </td>
                            </tr>
                            ` : `
                            <tr>
                                <td><strong>Implanta√ß√£o e Configura√ß√£o Padr√£o</strong></td>
                                <td><strong>R$ ${prices.standardSetup.toFixed(2)}</strong></td>
                            </tr>
                            `}
                            ${setupDiscount > 0 ? `
                            <tr style="background: #D4EDDA;">
                                <td colspan="2">
                                    <strong style="color: #155724;">üí∞ Desconto Aplicado: R$ ${setupDiscount.toFixed(2)}</strong><br>
                                    <small>Desconto autorizado pelo Gerente Comercial <strong>Daniel Gois</strong></small>
                                    ${discountReason ? `<br><small><em>Motivo: ${discountReason}</em></small>` : ''}
                                </td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>VALOR FINAL DA IMPLANTA√á√ÉO</strong></td>
                                <td><strong>R$ ${oneTimeTotal.toFixed(2)}</strong></td>
                            </tr>
                            ` : ''}
                        </tbody>
                    </table>
                    <div class="highlight-box">
                        <strong>Facilitamos seu investimento:</strong> Valores de desenvolvimento e implanta√ß√£o podem ser parcelados em at√© <strong>6x sem juros</strong> no cart√£o de cr√©dito.
                    </div>
                    ` : ''}

                    <h3>Suporte e Treinamento</h3>
                    <ul>
                        <li><strong>Suporte T√©cnico:</strong> Via WhatsApp, e-mail e telefone em hor√°rio comercial</li>
                        <li><strong>Treinamento Inicial:</strong> Configura√ß√£o completa e capacita√ß√£o da equipe</li>
                        <li><strong>Documenta√ß√£o:</strong> Acesso a manuais e tutoriais em v√≠deo</li>
                        <li><strong>Evolu√ß√£o Cont√≠nua:</strong> Sem fidelidade e com compromisso - a plataforma evolui constantemente e sua mensalidade permanece a mesma</li>
                    </ul>

                    <h3>Pr√≥ximos Passos</h3>
                    <ol>
                        <li>Aprova√ß√£o da proposta</li>
                        <li>Assinatura do contrato</li>
                        <li>Pagamento da implanta√ß√£o (se aplic√°vel)</li>
                        <li>Configura√ß√£o e treinamento da equipe</li>
                        <li>In√≠cio da opera√ß√£o</li>
                    </ol>

                    <div class="highlight-box">
                        <strong>Validade da Proposta:</strong> 15 dias corridos a partir da data de emiss√£o.
                    </div>

                    <div class="footer">
                        <p><strong>AtendeSEG</strong> - Plataforma Omnichannel para Corretoras de Seguros</p>
                        <p>D√∫vidas? Entre em contato conosco!</p>
                        <p style="margin-top: 20px; font-size: 12px;">
                            Este documento √© uma proposta comercial e n√£o representa um contrato vinculativo.<br>
                            Os termos finais ser√£o estabelecidos no contrato de presta√ß√£o de servi√ßos.
                        </p>
                    </div>
                </body>
                </html>
            `;
        }

        updateDisplay();
    </script>
</body>
</html>
